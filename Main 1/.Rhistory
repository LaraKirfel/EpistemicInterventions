mean_time=mean(duration/60),
sd_time=sd(duration/60)
)
df.exp_desc <- df.exp %>%
select(participant, scenario) %>%
group_by(scenario) %>%
summarize(n=n())
####final with counterfacual responses - coarse -grained
df.exp_long = df.exp %>%
select(scenario,
order,
participant,
contains("cause"),
contains("could"),
contains("blame"),
contains("counterfactual_"))%>%
gather(condition, rating, "cause_1":"counterfactual_2") %>%
mutate(ignorance = ifelse(str_detect(condition, "1"),
"many actions", "few actions")) %>%
mutate(condition = ifelse(str_detect(condition, "cause"),"causal_rating",
ifelse(str_detect(condition, "could"), "know_rating",
ifelse(str_detect(condition, "blame"), "blame_rating", "counterfactual"
)))) %>%
spread(condition, rating) %>%
mutate(scenario=as.factor(scenario)) %>%
mutate(ignorance=as.factor(ignorance)) %>%
mutate(causal_rating=as.numeric(causal_rating)) %>%
mutate(know_rating=as.numeric(know_rating)) %>%
mutate(blame_rating=as.numeric(blame_rating)) %>%
mutate(counterfactual=recode(counterfactual,
'1' = "causal action",
'2_0' = "epistemic change",
'2_1' = "... by reading (at least) one more" ,
'2_2' = "... by reading all e-mails",
'2_3' = "... by other",
'2_4' = "... by other",
'3' = "... by other",
'4' =  "environment" )) %>%
mutate(counterfactual=factor(counterfactual, levels=c("causal action", "epistemic change", "... by reading (at least) one more", "... by reading all e-mails", "... by other", "environment", "X")))
### Dataframe just with CF Responses (non-sensical deleted)
df.exp_cf<- df.exp_long %>%
select(participant, scenario, order, ignorance, counterfactual) %>%
reshape(v.names="counterfactual", timevar="ignorance", idvar=c("participant", "scenario", "order"),
direction="wide") %>%
filter(`counterfactual.few actions` != "X" ) %>% ###delete those participants who selected a non-sensical answer
reshape(idvar=c("participant", "scenario", "order"),
sep = ".", direction = "long") %>%  ###reshape back into long format
remove_rownames()
### Dataframe just with CF Responses (non-sensical deleted)
df.exp_cf<- df.exp_long %>%
select(participant, scenario, order, ignorance, counterfactual) %>%
reshape(v.names="counterfactual", timevar="ignorance", idvar=c("participant", "scenario", "order"),
direction="wide") %>%
filter(`counterfactual.few actions` != "X" ) %>% ###delete those participants who selected a non-sensical answer
reshape(idvar=c("participant", "scenario", "order"),
sep = ".", direction = "long") %>%  ###reshape back into long format
remove_rownames()
df.exp_cf_desc <- df.exp_cf%>%
select(scenario, counterfactual, ignorance) %>%
group_by(counterfactual,ignorance) %>%
summarize(n=n()) %>%
ungroup(counterfactual) %>%
mutate(total=sum(n)/2,
freq=n/total)
df.exp_desc_ratings<- df.exp_long%>%
group_by(ignorance) %>%
summarise(c_mean = mean(causal_rating),#causal rating
c_sd   = sd(causal_rating),
c_se   = c_sd / sqrt(n()),
c_upper_ci = c_mean+c_se*1.96,
c_lower_ci = c_mean-c_se*1.96,
k_mean = mean(know_rating),#could have known rating
k_sd   = sd(know_rating),
k_se   = k_sd / sqrt(n()),
k_upper_ci = k_mean+c_se*1.96,
k_lower_ci = k_mean-c_se*1.96,
b_mean = mean(blame_rating),#blame rating
b_sd   = sd(blame_rating),
b_se   = b_sd / sqrt(n()),
b_upper_ci = b_mean+c_se*1.96,
b_lower_ci = b_mean-c_se*1.96
)
df.exp_long <- within(df.exp_long, ignorance <- relevel(ignorance, ref = 'many actions'))
df.exp_long <- within(df.exp_long, scenario<- relevel(scenario, ref = 'bakery'))
mixed(causal_rating ~ 1 + ignorance*scenario +  (1 | participant), df.exp_long, method = 'LRT')
C3  <- lmer(causal_rating ~ 1 + ignorance*scenario + (1 | participant), df.exp_long, REML=T)
summary(C3)
emmeans(C3, list(pairwise ~ ignorance), adjust = "tukey")
df.exp_cf_desc <- df.exp_cf%>%
select(scenario, counterfactual, ignorance) %>%
group_by(counterfactual,ignorance) %>%
summarize(n=n()) %>%
ungroup(counterfactual) %>%
mutate(total=sum(n)/2,
freq=n/total)
View(df.exp_cf_desc)
vglm2 <- vglm(counterfactual ~ ignorance*scenario, family=multinomial(refLevel="causal action"), df.exp_cf)
vglm1 <- vglm(counterfactual ~ ignorance, family=multinomial(refLevel="causal action"), df.exp_cf)
vglm0 <- vglm(counterfactual ~ +1, family=multinomial(refLevel="causal action"), df.exp_cf)
summary(vglm1)
df.exp_cf <- within(df.exp_cf, ignorance <- relevel(ignorance, ref = 'many actions'))
library(VGAM)
vglm2 <- vglm(counterfactual ~ ignorance*scenario, family=multinomial(refLevel="causal action"), df.exp_cf)
vglm1 <- vglm(counterfactual ~ ignorance, family=multinomial(refLevel="causal action"), df.exp_cf)
vglm0 <- vglm(counterfactual ~ +1, family=multinomial(refLevel="causal action"), df.exp_cf)
summary(vglm1)
emmeans(C2, list(pairwise ~ ignorance), adjust = "tukey")
df.exp_long <- within(df.exp_long, ignorance <- relevel(ignorance, ref = 'few actions'))
df.exp_long <- within(df.exp_long, scenario<- relevel(scenario, ref = 'bakery'))
mixed(know_rating ~ 1 + ignorance*scenario +  (1 | participant), df.exp_long, method = 'LRT')
K3  <- lmer(know_rating ~ 1 + ignorance*scenario + (1 | participant), df.exp_long, REML=T)
summary(K3)
##Post-Hoc Test: Ignorance
emmeans(C2, list(pairwise ~ ignorance), adjust = "tukey")
mixed(know_rating ~ 1 + ignorance*scenario +  (1 | participant), df.exp_long, method = 'LRT')
K3  <- lmer(know_rating ~ 1 + ignorance*scenario + (1 | participant), df.exp_long, REML=T)
summary(K3)
emmeans(K3, list(pairwise ~ ignorance), adjust = "tukey")
mixed(blame_rating ~ 1 + ignorance*scenario +  (1 | participant), df.exp_long, method = 'LRT')
B3  <- lmer(blame_rating ~ 1 + ignorance*scenario + (1 | participant), df.exp_long, REML=T)
summary(B3)
##Post-Hoc Test: Ignorance
emmeans(B3, list(pairwise ~ ignorance), adjust = "tukey")
df.data = read.csv(file = "EpStates_4_noInfo.csv", stringsAsFactors = F, sep = ",") %>%
filter(row_number() > 2) %>% # additional rows in qualtrics csv
clean_names() %>%
filter(distribution_channel != "preview",
!condition =="", #exclude bot fails,
progress ==100| progress==99|progress==98)
df.exp = df.data %>%
mutate(participant = 1:n()) %>%
rename(duration=duration_in_seconds) %>%
mutate(duration=as.numeric(duration)) %>%
select(h_check_fact_1:b_outcome_a1_4,
participant,
order,
duration,
condition,
gender,
age,
-starts_with("q")
) %>%
gather("index", "value", -c(age, gender, participant, condition, duration, order))%>%
filter(value != "") %>%
arrange(index)%>%
mutate(index = ifelse(str_detect(index,"_c_1"),
"cause_1",
index))%>%
mutate(index = ifelse(str_detect(index,"_c_2"),
"cause_2",
index))%>%
mutate(index = ifelse(str_detect(index,"_cf_1"),
"cf_externally_caused",
index))%>%
mutate(index = ifelse(str_detect(index,"_cf_2"),
"cf_self_caused",
index)) %>%
mutate(index = ifelse(str_detect(index,"_k_1"),
"could_1",
index))%>%
mutate(index = ifelse(str_detect(index,"_k_2"),
"could_2",
index))%>%
mutate(index = ifelse(str_detect(index,"_b_1"),
"blame_1",
index))%>%
mutate(index = ifelse(str_detect(index,"_b_2"),
"blame_2",
index))%>%
mutate(index = ifelse(str_detect(index,"_look_a1"),
"look_a1",
index))%>%
mutate(index = ifelse(str_detect(index,"_look_a2"),
"look_a2",
index)) %>%
mutate(index = ifelse(str_detect(index,"_outcome_a1_"),
"outcome_a1",
index))%>%
mutate(index = ifelse(str_detect(index,"_outcome_a2_"),
"outcome_a2",
index))%>%
mutate(index = ifelse(str_detect(index,"fact_1"),
"fact_1",
index))%>%
mutate(index = ifelse(str_detect(index,"fact_2"),
"fact_2",
index))%>%
mutate(index = ifelse(str_detect(index,"know_1"),
"know_1",
index))%>%
mutate(index = ifelse(str_detect(index,"know_2"),
"know_2",
index)) %>%
mutate(index = ifelse(str_detect(index,"mail_1"),
"mail_1",
index))%>%
mutate(index = ifelse(str_detect(index,"mail_2"),
"mail_2",
index)) %>%
mutate(index = ifelse(str_detect(index,"read_1"),
"read_1",
index))%>%
mutate(index = ifelse(str_detect(index,"read_2"),
"read_2",
index)) %>%
mutate(order = ifelse(order == 1,"dont know first",
ifelse(order == 2, "know first", " ")))%>%
mutate(scenario = ifelse(condition == 1,"hospital",
ifelse(condition == 2, "garden",
ifelse(condition == 3, "bakery", " "))))%>%
spread(index, value) %>%
arrange(participant)
####Experiment 4: Create filter
df.exp<- df.exp%>%
mutate(check_total=if_else(know_1=="2", 1, 0)) %>%
mutate(check_total=if_else(know_2 =="2", check_total+1, check_total)) %>%
mutate(check_total=if_else(fact_1 =="1", check_total+1, check_total)) %>%
mutate(check_total=if_else(fact_2=="1",  check_total+1, check_total)) %>%
mutate(check_total=if_else(read_1=="1",  check_total+1, check_total)) %>%
mutate(check_total=if_else(read_2=="2",  check_total+1, check_total)) %>%
mutate(check_total=if_else(mail_1=="1",  check_total+1, check_total)) %>%
mutate(check_total=if_else(mail_2=="1",  check_total+1, check_total))
#### Set filter
df.exp<-df.exp %>%
filter(check_total ==8) ####Set to 4 to change exlusion criterion to "all check questions correct"
df.counterfactuals<-read.csv("Counterfactuals_analysed.csv") %>%
select(participant, counterfactual_1, counterfactual_2)
df.exp<-df.exp %>%
inner_join(df.counterfactuals, by="participant") %>%
filter(counterfactual_1 != "X" ) %>%
filter(counterfactual_2 != "X")
#Counterfactual responses
##########
df.exp_long = df.exp %>%
select(scenario,
order,
participant,
contains("cause"),
contains("could"),
contains("blame"),
contains("counterfactual_"),
-starts_with("cf")
) %>%
gather(condition, rating, "cause_1":"counterfactual_2") %>%
mutate(ignorance = ifelse(str_detect(condition, "1"),
"reads e-mail", "doesn't read e-mail")) %>%
mutate(condition = ifelse(str_detect(condition, "cause"),"causal_rating",
ifelse(str_detect(condition, "could"), "know_rating",
ifelse(str_detect(condition, "blame"), "blame_rating", "counterfactual"
)))) %>%
spread(condition, rating) %>%
mutate(scenario=as.factor(scenario)) %>%
mutate(ignorance=as.factor(ignorance)) %>%
mutate(causal_rating=as.numeric(causal_rating)) %>%
mutate(know_rating=as.numeric(know_rating)) %>%
mutate(blame_rating=as.numeric(blame_rating)) %>%
mutate(counterfactual=recode(counterfactual,
'1' = "causal action",
'2_0' = "epist. change",
'2_2_1' = "... by e-mail reading",
'2_1' = "... by info" ,
'2_2' = "... by info + e-mail reading",
'2_3' = "... by other action of agent",
'2_4' = "... by someone else",
'4' =  "environment" ))%>%
mutate(counterfactual=factor(counterfactual, levels=c("epist. change", "... by info", "... by info + e-mail reading", "... by other action of agent", "... by someone else", "causal action", "... by e-mail reading", "environment"))) %>%
mutate(ignorance=factor(ignorance, levels= c( "doesn't read e-mail", "reads e-mail")))
df.exp_cf_desc <- df.exp_cf%>%
select(scenario, counterfactual, ignorance) %>%
group_by(counterfactual,ignorance) %>%
summarize(n=n()) %>%
ungroup(counterfactual) %>%
mutate(total=sum(n)/2,
freq=n/total)
#Counterfactual responses
##########
df.exp_long = df.exp %>%
select(scenario,
order,
participant,
contains("cause"),
contains("could"),
contains("blame"),
contains("counterfactual_"),
-starts_with("cf")
) %>%
gather(condition, rating, "cause_1":"counterfactual_2") %>%
mutate(ignorance = ifelse(str_detect(condition, "1"),
"reads e-mail", "doesn't read e-mail")) %>%
mutate(condition = ifelse(str_detect(condition, "cause"),"causal_rating",
ifelse(str_detect(condition, "could"), "know_rating",
ifelse(str_detect(condition, "blame"), "blame_rating", "counterfactual"
)))) %>%
spread(condition, rating) %>%
mutate(scenario=as.factor(scenario)) %>%
mutate(ignorance=as.factor(ignorance)) %>%
mutate(causal_rating=as.numeric(causal_rating)) %>%
mutate(know_rating=as.numeric(know_rating)) %>%
mutate(blame_rating=as.numeric(blame_rating)) %>%
mutate(counterfactual=recode(counterfactual,
'1' = "causal action",
'2_0' = "epist. change",
'2_2_1' = "... by e-mail reading",
'2_1' = "... by info" ,
'2_2' = "... by info + e-mail reading",
'2_3' = "... by other action of agent",
'2_4' = "... by someone else",
'4' =  "environment" ))%>%
mutate(counterfactual=factor(counterfactual, levels=c("epist. change", "... by info", "... by info + e-mail reading", "... by other action of agent", "... by someone else", "causal action", "... by e-mail reading", "environment"))) %>%
mutate(ignorance=factor(ignorance, levels= c( "doesn't read e-mail", "reads e-mail")))
df.exp_cf_desc <- df.exp_cf%>%
select(scenario, counterfactual, ignorance) %>%
group_by(counterfactual,ignorance) %>%
summarize(n=n()) %>%
ungroup(counterfactual) %>%
mutate(total=sum(n)/2,
freq=n/total)
df.data = read.csv(file = "EpStates_4_noInfo.csv", stringsAsFactors = F, sep = ",") %>%
filter(row_number() > 2) %>% # additional rows in qualtrics csv
clean_names() %>%
filter(distribution_channel != "preview",
!condition =="", #exclude bot fails,
progress ==100| progress==99|progress==98)
df.exp = df.data %>%
mutate(participant = 1:n()) %>%
rename(duration=duration_in_seconds) %>%
mutate(duration=as.numeric(duration)) %>%
select(h_check_fact_1:b_outcome_a1_4,
participant,
order,
duration,
condition,
gender,
age,
-starts_with("q")
) %>%
gather("index", "value", -c(age, gender, participant, condition, duration, order))%>%
filter(value != "") %>%
arrange(index)%>%
mutate(index = ifelse(str_detect(index,"_c_1"),
"cause_1",
index))%>%
mutate(index = ifelse(str_detect(index,"_c_2"),
"cause_2",
index))%>%
mutate(index = ifelse(str_detect(index,"_cf_1"),
"cf_externally_caused",
index))%>%
mutate(index = ifelse(str_detect(index,"_cf_2"),
"cf_self_caused",
index)) %>%
mutate(index = ifelse(str_detect(index,"_k_1"),
"could_1",
index))%>%
mutate(index = ifelse(str_detect(index,"_k_2"),
"could_2",
index))%>%
mutate(index = ifelse(str_detect(index,"_b_1"),
"blame_1",
index))%>%
mutate(index = ifelse(str_detect(index,"_b_2"),
"blame_2",
index))%>%
mutate(index = ifelse(str_detect(index,"_look_a1"),
"look_a1",
index))%>%
mutate(index = ifelse(str_detect(index,"_look_a2"),
"look_a2",
index)) %>%
mutate(index = ifelse(str_detect(index,"_outcome_a1_"),
"outcome_a1",
index))%>%
mutate(index = ifelse(str_detect(index,"_outcome_a2_"),
"outcome_a2",
index))%>%
mutate(index = ifelse(str_detect(index,"fact_1"),
"fact_1",
index))%>%
mutate(index = ifelse(str_detect(index,"fact_2"),
"fact_2",
index))%>%
mutate(index = ifelse(str_detect(index,"know_1"),
"know_1",
index))%>%
mutate(index = ifelse(str_detect(index,"know_2"),
"know_2",
index)) %>%
mutate(index = ifelse(str_detect(index,"mail_1"),
"mail_1",
index))%>%
mutate(index = ifelse(str_detect(index,"mail_2"),
"mail_2",
index)) %>%
mutate(index = ifelse(str_detect(index,"read_1"),
"read_1",
index))%>%
mutate(index = ifelse(str_detect(index,"read_2"),
"read_2",
index)) %>%
mutate(order = ifelse(order == 1,"dont know first",
ifelse(order == 2, "know first", " ")))%>%
mutate(scenario = ifelse(condition == 1,"hospital",
ifelse(condition == 2, "garden",
ifelse(condition == 3, "bakery", " "))))%>%
spread(index, value) %>%
arrange(participant)
####Experiment 4: Create filter
df.exp<- df.exp%>%
mutate(check_total=if_else(know_1=="2", 1, 0)) %>%
mutate(check_total=if_else(know_2 =="2", check_total+1, check_total)) %>%
mutate(check_total=if_else(fact_1 =="1", check_total+1, check_total)) %>%
mutate(check_total=if_else(fact_2=="1",  check_total+1, check_total)) %>%
mutate(check_total=if_else(read_1=="1",  check_total+1, check_total)) %>%
mutate(check_total=if_else(read_2=="2",  check_total+1, check_total)) %>%
mutate(check_total=if_else(mail_1=="1",  check_total+1, check_total)) %>%
mutate(check_total=if_else(mail_2=="1",  check_total+1, check_total))
#### Set filter
df.exp<-df.exp %>%
filter(check_total ==8) ####Set to 4 to change exlusion criterion to "all check questions correct"
df.counterfactuals<-read.csv("Counterfactuals_analysed.csv") %>%
select(participant, counterfactual_1, counterfactual_2)
df.exp<-df.exp %>%
inner_join(df.counterfactuals, by="participant") %>%
filter(counterfactual_1 != "X" ) %>%
filter(counterfactual_2 != "X")
#Counterfactual responses
##########
df.exp_long = df.exp %>%
select(scenario,
order,
participant,
contains("cause"),
contains("could"),
contains("blame"),
contains("counterfactual_"),
-starts_with("cf")
) %>%
gather(condition, rating, "cause_1":"counterfactual_2") %>%
mutate(ignorance = ifelse(str_detect(condition, "1"),
"reads e-mail", "doesn't read e-mail")) %>%
mutate(condition = ifelse(str_detect(condition, "cause"),"causal_rating",
ifelse(str_detect(condition, "could"), "know_rating",
ifelse(str_detect(condition, "blame"), "blame_rating", "counterfactual"
)))) %>%
spread(condition, rating) %>%
mutate(scenario=as.factor(scenario)) %>%
mutate(ignorance=as.factor(ignorance)) %>%
mutate(causal_rating=as.numeric(causal_rating)) %>%
mutate(know_rating=as.numeric(know_rating)) %>%
mutate(blame_rating=as.numeric(blame_rating)) %>%
mutate(counterfactual=recode(counterfactual,
'1' = "causal action",
'2_0' = "epist. change",
'2_2_1' = "... by e-mail reading",
'2_1' = "... by info" ,
'2_2' = "... by info + e-mail reading",
'2_3' = "... by other action of agent",
'2_4' = "... by someone else",
'4' =  "environment" ))%>%
mutate(counterfactual=factor(counterfactual, levels=c("epist. change", "... by info", "... by info + e-mail reading", "... by other action of agent", "... by someone else", "causal action", "... by e-mail reading", "environment"))) %>%
mutate(ignorance=factor(ignorance, levels= c( "doesn't read e-mail", "reads e-mail")))
df.exp_cf_desc <- df.exp_cf%>%
select(scenario, counterfactual, ignorance) %>%
group_by(counterfactual,ignorance) %>%
summarize(n=n()) %>%
ungroup(counterfactual) %>%
mutate(total=sum(n)/2,
freq=n/total)
### Dataframe just with CF Responses
#### delete those with less than 5% reponses
df.exp_cf<- df.exp_long %>%
select(participant, scenario, order, ignorance, counterfactual) %>%
filter(!str_detect(counterfactual, 'causal action')) %>%
filter(!str_detect(counterfactual, 'environment')) %>%
filter(!str_detect(counterfactual, '... by e-mail reading'))
df.exp_cf_desc <- df.exp_cf%>%
select(scenario, counterfactual, ignorance) %>%
group_by(counterfactual,ignorance) %>%
summarize(n=n()) %>%
ungroup(counterfactual) %>%
mutate(total=sum(n)/2,
freq=n/total)
####Look and Outcome Ratings
df.exp_long2 = df.exp %>%
select(scenario,
order,
participant,
contains("look"),
contains("outcome"),
-starts_with("cf"))%>%
gather(condition, rating, "look_a1":"outcome_a2") %>%
mutate(ignorance = ifelse(str_detect(condition, "_a1"),
"read e-mail", "didn't read e-mail")) %>%
mutate(condition = ifelse(str_detect(condition, "look"),"look_rating", "outcome_rating"
))%>%
spread(condition, rating) %>%
mutate(scenario=as.factor(scenario)) %>%
mutate(ignorance=as.factor(ignorance)) %>%
mutate(look_rating=as.numeric(look_rating)) %>%
mutate(outcome_rating=as.numeric(outcome_rating))
mixed(causal_rating ~ 1 + ignorance*scenario +  (1 | participant), df.exp_long, method = 'LRT')
C4  <- lmer(causal_rating ~ 1 + ignorance*scenario + (1 | participant), df.exp_long, REML=T)
summary(C4)
emmeans(C2, list(pairwise ~ ignorance), adjust = "tukey")
emmeans(C4, list(pairwise ~ ignorance), adjust = "tukey")
df.exp_cf_desc <- df.exp_cf%>%
select(scenario, counterfactual, ignorance) %>%
group_by(counterfactual,ignorance) %>%
summarize(n=n()) %>%
ungroup(counterfactual) %>%
mutate(total=sum(n)/2,
freq=n/total)
